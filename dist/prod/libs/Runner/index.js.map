{"version":3,"file":"libs/Runner/index.js","mappings":"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","sources":["webpack://rbrython/./src/rbry/corelib-aot/int.js","webpack://rbrython/./src/rbry/runners/interface.ts","webpack://rbrython/./src/rbry/runlib/helpers/getClass.ts","webpack://rbrython/./src/rbry/runlib/interface/op.ts","webpack://rbrython/./src/rbry/runlib/interface/KW.ts","webpack://rbrython/./src/rbry/runlib/interface/tmp.ts","webpack://rbrython/./src/rbry/runlib/index.ts","webpack://rbrython/./src/rbry/runlib/interface/uop.ts","webpack://rbrython/./src/rbry/runlib/interface/call.ts","webpack://rbrython/./src/rbry/runlib/helpers/isClass.ts","webpack://rbrython/./src/rbry/runlib/interface/mcall.ts","webpack://rbrython/./src/rbry/runlib/interface/assert.ts","webpack://rbrython/./src/rbry/runlib/interface/attr.ts","webpack://rbrython/./src/rbry/runlib/interface/setattr.ts","webpack://rbrython/./src/rbry/runlib/interface/getModule.ts","webpack://rbrython/./src/rbry/runlib/interface/getModuleSync.ts","webpack://rbrython/./src/rbry/corelib-aot/mfct.js","webpack://rbrython/./src/rbry/corelib-aot/bool.js","webpack://rbrython/./src/rbry/corelib-aot/str.js","webpack://rbrython/./src/rbry/corelib-aot/float.js","webpack://rbrython/./src/rbry/runners/RBrythonGlobalRunner.ts","webpack://rbrython/webpack/bootstrap","webpack://rbrython/webpack/runtime/define property getters","webpack://rbrython/webpack/runtime/hasOwnProperty shorthand","webpack://rbrython/./src/libs/Runner/index.ts"],"sourcesContent":["export default \";\\n;\\nvar int = (() =>{\\n        function int() {\\n            return Object.create(int.prototype);\\n        }\\n    int.prototype.__new__ = function __new__(o, base, ){const cls = this;\\n        if( $RB.op($RB.call(type, o, ), \\\"eq\\\", str) ) {\\n        return (\\n\\n                    (x, base) => {\\n\\n                        if( base !== 16)\\n\\n                            return BigInt(x);\\n\\n                        \\n\\n                        let result = 0n;\\n\\n                        for(let i = 2; i < x.length; ++i)\\n\\n                            result = result << 4n + BigInt( parseInt(this.slice(i, i+8), 16) );\\n\\n                        return result;\\n\\n                    }\\n\\n                )(o,base);\\n\\n    };\\nreturn $RB.mcall($RB.call(type, o, ), \\\"__int__\\\", o,  );\\n\\n    };\\nint.prototype.__eq__ = function __eq__(o, ){const self = this;\\n        return self == o;\\n\\n    };\\nint.prototype.__add__ = function __add__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self + o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__radd__ = function __radd__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return o + self;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__sub__ = function __sub__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self - o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__rsub__ = function __rsub__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return o - self;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__mul__ = function __mul__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self * o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__rmul__ = function __rmul__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return o * self;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__pow__ = function __pow__(o, mod, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self ** o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__rpow__ = function __rpow__(o, mod, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return o ** self;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__div__ = function __div__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return Number(self) / Number(o);\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__rdiv__ = function __rdiv__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return Number(o) * Number(self);\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__mod__ = function __mod__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self % o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__rmod__ = function __rmod__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self % o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__or__ = function __or__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self | o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__ror__ = function __ror__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self | o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__and__ = function __and__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self & o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__rand__ = function __rand__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self & o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__xor__ = function __xor__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self ^ o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__rxor__ = function __rxor__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self ^ o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__lshift__ = function __lshift__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self << o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__rlshift__ = function __rlshift__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self << o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__rshift__ = function __rshift__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self >> o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__rrshift__ = function __rrshift__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self >> o;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nint.prototype.__invert__ = function __invert__(){const self = this;\\n        return ~self;\\n\\n    };\\nint.prototype.__neg__ = function __neg__(){const self = this;\\n        return -self;\\n\\n    };\\nint.prototype.__abs__ = function __abs__(){const self = this;\\n        return (x => x < 0n ? -x : x)(self);\\n\\n    };\\n\\n        return int;\\n    })();\\n    ;\\n\\nconst __exported__ = {int}\";","export type PyModule = Record<string, any>;\n\nexport default abstract class Runner {\n    \n    abstract run(jscode: string): Promise<PyModule>;\n    abstract runSync(jscode: string): PyModule;\n\n    abstract registerBuiltins(symbols: PyModule): void;\n    abstract registerBuiltin(name: string, value: any): void;\n\n    abstract registerModule(name: string, symbols: PyModule): void;\n    abstract      getModule(name: string): PyModule;\n\n    // low level\n    abstract loadAsFunction(jscode: string): (runlib: any) => Promise<PyModule>;\n    abstract runFunction(fct: (runlib: any) => Promise<PyModule>): Promise<PyModule>;\n\n    abstract loadAsSyncFunction(jscode: string): (runlib: any) => PyModule;\n    abstract runSyncFunction(fct: (runlib: any) => PyModule): PyModule;\n}","const mapper = {\n    \"bigint\" : \"int\",\n    \"number\" : \"float\",\n    \"string\" : \"str\",\n    \"boolean\": \"bool\"\n}\n\nexport function getClass(o: unknown) {\n\n    const typename = typeof o;\n\n    if( typename === \"function\" ) {\n        //TODO: is class ? is something else ?\n        // @ts-ignore\n        return type;\n    }\n\n    if( typename === \"object\" ) {\n        // @ts-ignore;\n        return o.constructor;\n    }\n\n    // @ts-ignore\n    const lit_class = globalThis[mapper[typename]];\n    if( lit_class !== undefined)\n        return lit_class;\n\n    throw new Error(`JS type ${typename} not implemented yet`);\n}","import { getClass } from \"../helpers/getClass\";\n\n// @ts-ignore\nconst NotImplemented = globalThis.NotImplemented = Symbol();\n\nexport default function op(a: unknown, op: string, b: unknown) {\n\n    const ka = getClass(a);\n    if( ka === undefined ) {\n        console.warn(a, op);\n        throw new Error(\"?\")\n    }\n\n    let result = NotImplemented;\n\n    let fct = ka.prototype[`__${op}__`];\n    if( fct !== undefined )\n        result = fct.call(a, b);\n\n    if( result !== NotImplemented)\n        return result;\n    \n    // iop\n    if( op[0] === \"i\" ) {\n\n        op = op.slice(1);\n        fct = ka.prototype[`__${op}__`];\n        \n        if( fct !== undefined)\n            result = fct.call(a, b)\n\n        if( result !== NotImplemented)\n            return result;\n    }\n\n    // try to reverse\n    const kb = getClass(b);\n    if( kb === undefined ) {\n        console.warn(b, \"r\" + op);\n        throw new Error(\"?\");\n    }\n\n    let rop;\n    if( op.length == 2 && op !== \"or\" ) // cmp\n        rop = cmp_reversed[op as keyof typeof cmp_reversed];\n    else\n        rop = `r${op}`;\n    \n    fct = kb.prototype[`__${rop}__`];\n    if( fct !== undefined )\n        result = fct.call(b, a);\n\n    if( result !== NotImplemented)\n        return result;\n\n    // fallbacks\n    if( op === \"eq\" ) return a === b;\n    if( op === \"ne\" ) return a !== b;\n    \n    throw new Error(`Operation not implemented ${ka.name} ${op} ${kb.name}`);\n}\n\nconst cmp_reversed = {\n    \"lt\": \"gt\",\n    \"gt\": \"lt\",\n    \"le\": \"ge\",\n    \"ge\": \"le\",\n    \"ne\": \"ne\",\n    \"eq\": \"eq\"\n}","export let KW: Record<string, any>|null = null;\n\nexport const IGNORE_ARG = Symbol();\n\nexport function setKW(args: Record<string, any>) {\n    KW = args;\n    return IGNORE_ARG;\n}\n\nexport function getKW() {\n    if( KW === null )\n        return {};\n    const args = KW;\n    KW = null;\n    return args;\n}","let _tmp: any = null;\n\nexport function saveTmp(v: any): any {\n    return _tmp = v;\n}\n\nexport function tmp(): any { // may reuse many time ?\n    return _tmp;\n}\n\nexport function getTmp(): any {\n    const tmp = _tmp;\n    _tmp = null\n    return tmp;\n}\n\nexport function withTmp(value: any): any {\n    _tmp = null;\n    return value;\n}\n\n/*\nexport function saveTmp(v: any): any {\n    return tmp = v;\n}\nexport function releaseTmp(v: any) {\n    tmp = null;\n    return v;\n}*/\n\n","// interface\nimport op     from \"./interface/op\";\nimport uop    from \"./interface/uop\";\nimport call   from \"./interface/call\";\nimport mcall  from \"./interface/mcall\";\nimport assert from \"./interface/assert\";\nimport attr   from \"./interface/attr\";\nimport setattr from \"./interface/setattr\";\nimport getModule from \"./interface/getModule\";\nimport { getTmp, saveTmp, tmp, withTmp } from \"./interface/tmp\";\nimport { getKW, setKW } from \"./interface/KW\";\n\n// @ts-ignore\nconst $RB = globalThis.$RB = {\n    // interface\n    op,\n    uop,\n    call,\n    mcall,\n    assert,\n    attr,\n    setattr,\n    getKW,\n    setKW,\n    tmp,\n    getTmp,\n    saveTmp,\n    withTmp,\n    getModule,\n    getModuleSync,\n    getClass\n}\nexport {$RB};\n\n//TODO: corelib\nimport { getClass } from \"./helpers/getClass\";\nimport getModuleSync from \"./interface/getModuleSync\";\n\n// @ts-ignore\nglobalThis.abs = function( a: unknown) {\n    const ka = getClass(a);\n    return ka.prototype[`__abs__`].call(a);\n}\n\n// @ts-ignore\nglobalThis.range = function*(...args: bigint[]) {\n    let beg = 0n;\n    let end = args[0];\n    let inc = 1n;\n\n    if( args.length >= 2) {\n        beg = args[0]\n        end = args[1]\n\n        if( args.length === 3)\n            inc = args[2];\n    }\n\n    for(let i = beg; i < end; i+= inc)\n        yield i;\n}\n\n// @ts-ignore\nglobalThis.Exception = function(msg: string) {\n    throw new Error(msg);\n}\n\n// =====================================================\n\n//TODO: as macro...\nexport const IVALUE = Symbol();\n\n// @ts-ignore\nglobalThis.__JS_SET_IVALUE__ = (self, v) => self[IVALUE] = v;\n// @ts-ignore\nglobalThis.__JS_GET_IVALUE__ = (self) => self[IVALUE];","import { getClass } from \"../helpers/getClass\";\n\nexport default function uop(op:string, a: unknown) {\n\n    const ka = getClass(a);\n\n    if( ka === undefined ) {\n        console.warn(a, op);\n        throw new Error(\"?\")\n    }\n\n    let fct = ka.prototype[`__${op}__`];\n    return fct.call(a);\n}","import { getClass } from \"../helpers/getClass\";\nimport isClass from \"../helpers/isClass\";\nimport { IGNORE_ARG } from \"./KW\";\n\nexport default function call(a: (...args:unknown[]) => unknown, ...args: unknown[]) {\n\n    if( args[args.length-1] === IGNORE_ARG)\n        args = args.slice(0,-1);\n\n    // @ts-ignore\n    let fct = a.__call__\n\n    if( fct === undefined ) {\n        fct = a;\n\n        // h4cky\n        if( fct.prototype?.__new__ !== undefined ) {\n            const b = getClass(fct).prototype.__call__;\n            if( b !== undefined) {\n                return b.call(fct, ...args);\n            }\n        }\n\n        if( isClass(fct) ) // only for JS classes now...\n            return new fct(...args);\n    }\n\n    return fct(...args);\n}\n","export default function isClass(o: unknown) {\n    // from https://stackoverflow.com/questions/526559/testing-if-something-is-a-class-in-javascript\n    return Object.getOwnPropertyDescriptors(o)?.prototype?.writable === false;\n}\n// + https://github.com/brython-dev/brython/issues/2513","import { IGNORE_ARG } from \"./KW\";\n\nexport default function mcall(o: unknown, name: string, ...args: unknown[]) {\n    \n    if( args[args.length-1] === IGNORE_ARG)\n        args = args.slice(0,-1);\n    \n    // @ts-ignore\n    let fct = o[name];\n    if( fct === undefined) {\n        // @ts-ignore\n        if( o.prototype[name] === undefined) {\n            // @ts-ignore\n            console.warn(o, o.name, name);\n        }\n        // @ts-ignore\n        return o.prototype[name].call(...args);\n    }\n\n    // @ts-ignore\n    return o[name](...args);\n}","export default function assert(cond: boolean, msg: string = \"\") {\n    if( ! cond )\n        throw new Error(`Assertion failed: ${msg}`);\n}","export default function attr(o: any, attr: string) {\n    if( ! (attr in o) )\n        return o.constructor[attr];\n    return o[attr];\n}","export default function setattr(obj: object, key: string, value:unknown) {\n    // @ts-ignore\n    return obj[key] = value;\n}","import { modules } from \"@RBrython/rbry/runners/RBrythonGlobalRunner\";\n\nexport default async function getModule(name: string) {\n\n    // h4ck\n    const module = modules[name];\n    if( module !== undefined )\n        return module;\n\n    if( name in globalThis)\n        return modules[name] = globalThis[name as keyof typeof globalThis];\n\n    // TODO...\n    if( \"__BRYTHON__\" in globalThis) {\n        // @ts-ignore\n        if( name in __BRYTHON__.imported)\n            // @ts-ignore\n            return modules[name] = __BRYTHON__.pyobj2jsob(__BRYTHON__.imported[name]);\n    }\n    \n    throw new Error(`module ${name} not found`);\n}\n    ","import { modules } from \"@RBrython/rbry/runners/RBrythonGlobalRunner\";\n\nexport default function getModuleSync(name: string) {\n\n    // h4ck\n    const module = modules[name];\n    if( module !== undefined )\n        return module;\n\n    if( name in globalThis)\n        return modules[name] = globalThis[name as keyof typeof globalThis];\n\n    // TODO...\n    if( \"__BRYTHON__\" in globalThis) {\n        // @ts-ignore\n        if( name in __BRYTHON__.imported)\n            // @ts-ignore\n            return modules[name] = __BRYTHON__.pyobj2jsob(__BRYTHON__.imported[name]);\n    }\n    \n    throw new Error(`module ${name} not found`);\n}\n    ","export default \"function abs(o, ){\\n        return $RB.mcall(o, \\\"__abs__\\\",  );\\n\\n    };\\n\\nconst __exported__ = {abs}\";","export default \";\\nvar bool = (() =>{\\n        function bool() {\\n            return Object.create(bool.prototype);\\n        }\\n    bool.prototype.__eq__ = function __eq__(o, ){const self = this;\\n        return self == o;\\n\\n    };\\n\\n        return bool;\\n    })();\\n    ;\\n\\nconst __exported__ = {bool}\";","export default \";\\n;\\nvar str = (() =>{\\n        function str() {\\n            return Object.create(str.prototype);\\n        }\\n    str.prototype.__new__ = function __new__(o, ){const cls = this;\\n        return `${o}`;\\n\\n    };\\nstr.prototype.__eq__ = function __eq__(o, ){const self = this;\\n        return self == o;\\n\\n    };\\nstr.prototype.__mul__ = function __mul__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self.repeat(Number(b));\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nstr.prototype.__rmul__ = function __rmul__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"int\\\") {\\n            return self.repeat(Number(b));\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\n\\n        return str;\\n    })();\\n    ;\\n\\nconst __exported__ = {str}\";","export default \";\\n;\\nvar float = (() =>{\\n        function float() {\\n            return Object.create(float.prototype);\\n        }\\n    float.prototype.__new__ = function __new__(o, ){const cls = this;\\n        if( $RB.call(type, o, ) === str ) {\\n        if( $RB.op(o, \\\"eq\\\", \\\"infinity\\\")||$RB.op(o, \\\"eq\\\", \\\"inf\\\") ) {\\n        return Number.POSITIVE_INFINITY;\\n\\n    };\\nif( $RB.op(o, \\\"eq\\\", \\\"-infinity\\\")||$RB.op(o, \\\"eq\\\", \\\"-inf\\\") ) {\\n        return Number.NEGATIVE_INFINITY;\\n\\n    };\\nreturn Number(o);\\n\\n    };\\nreturn $RB.mcall($RB.call(type, o, ), \\\"__float__\\\", o,  );\\n\\n    };\\nfloat.prototype.__eq__ = function __eq__(o, ){const self = this;\\n        return self == o;\\n\\n    };\\nfloat.prototype.__add__ = function __add__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"float\\\") {\\n            return self + o;\\n\\n        }else if( tname === \\\"int\\\") {\\n            return self + Number(o);\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nfloat.prototype.__radd__ = function __radd__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"float\\\") {\\n            return o + self;\\n\\n        }else if( tname === \\\"int\\\") {\\n            return Number(o) + self;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nfloat.prototype.__sub__ = function __sub__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"float\\\") {\\n            return self - o;\\n\\n        }else if( tname === \\\"int\\\") {\\n            return self - Number(o);\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nfloat.prototype.__rsub__ = function __rsub__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"float\\\") {\\n            return o - self;\\n\\n        }else if( tname === \\\"int\\\") {\\n            return Number(o) - self;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nfloat.prototype.__mul__ = function __mul__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"float\\\") {\\n            return self * o;\\n\\n        }else if( tname === \\\"int\\\") {\\n            return self * Number(o);\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nfloat.prototype.__rmul__ = function __rmul__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"float\\\") {\\n            return o * self;\\n\\n        }else if( tname === \\\"int\\\") {\\n            return Number(o) * self;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nfloat.prototype.__div__ = function __div__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"float\\\") {\\n            return self / o;\\n\\n        }else if( tname === \\\"int\\\") {\\n            return self / Number(o);\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nfloat.prototype.__rdiv__ = function __rdiv__(o, ){const self = this;\\n        {const tname = type(o).name;if( tname === \\\"float\\\") {\\n            return o / self;\\n\\n        }else if( tname === \\\"int\\\") {\\n            return Number(o) / self;\\n\\n        }else {\\n            return NotImplemented;\\n\\n    }};\\n\\n    };\\nfloat.prototype.__neg__ = function __neg__(){const self = this;\\n        return -self;\\n\\n    };\\nfloat.prototype.__int__ = function __int__(){const self = this;\\n        return ((x) => Math.trunc(x))(self);\\n\\n    };\\nfloat.prototype.__abs__ = function __abs__(){const self = this;\\n        return ((x) => Math.abs(x))(self);\\n\\n    };\\n\\n        return float;\\n    })();\\n    ;\\n\\nconst __exported__ = {float}\";","import \"@RBrython/rbry/runlib\";\n\nimport Runner, { PyModule } from \"./interface\";\nimport { $RB } from \"@RBrython/rbry/runlib\";\n\nexport const modules: Record<string, any> = {};\n\nexport default class RBrythonGlobalRunner extends Runner {\n\n    #module   = modules; // h4ck\n    #builtins: Record<string, any> = {};\n\n    override async run(jscode: string) {\n        return await this.runFunction( this.loadAsFunction(jscode) );\n    }\n    override runSync(jscode: string) {\n        return this.runSyncFunction( this.loadAsSyncFunction(jscode) );\n    }\n\n    override loadAsFunction(jscode: string): (runlib: any) => Promise<PyModule> {\n        return eval(jscode) as (runlib: any) => Promise<PyModule>;\n    }\n    override async runFunction( fct: (runlib: any) => Promise<PyModule> ) {\n        return await fct($RB);\n    }\n\n    override loadAsSyncFunction(jscode: string): (runlib: any) => PyModule {\n        return eval(jscode) as (runlib: any) => PyModule;\n    }\n    override runSyncFunction( fct: (runlib: any) => PyModule ) {\n        return fct($RB);\n    }\n\n    // modules\n    override registerModule(name: string, symbols: PyModule): void {\n        this.#module[name] = symbols;\n    }\n    override getModule(name: string): PyModule {\n        return this.#module[name];\n    } \n\n    // builtins\n    override registerBuiltins(symbols: PyModule): void {\n        for(let name in symbols)\n            this.registerBuiltin(name, symbols[name]);\n    }\n    override registerBuiltin(name: string, value: any): void {\n        this.#builtins[name] = value;\n\n        // @ts-ignore\n        globalThis[name] = value;\n    }\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import Runner from \"@RBrython/rbry/runners/RBrythonGlobalRunner\";\n\nconst runner = new Runner();\n\nrunner.registerModule(\"JS\", globalThis);\n\nconst builtins = [\n    require(\"!!raw-loader!@RBrython/rbry/corelib-aot/bool.js\").default,\n    require(\"!!raw-loader!@RBrython/rbry/corelib-aot/float.js\").default,\n    require(\"!!raw-loader!@RBrython/rbry/corelib-aot/int.js\").default,\n    require(\"!!raw-loader!@RBrython/rbry/corelib-aot/str.js\").default,\n    require(\"!!raw-loader!@RBrython/rbry/corelib-aot/mfct.js\").default\n]\n\nfor(let builtin of builtins)\n    runner.registerBuiltins( runner.loadAsFunction( builtin ) );\n\nexport default runner;"],"names":["Runner","mapper","getClass","o","typename","type","constructor","lit_class","globalThis","undefined","Error","NotImplemented","Symbol","cmp_reversed","KW","IGNORE_ARG","_tmp","$RB","op","a","b","ka","console","warn","result","fct","prototype","call","slice","kb","rop","length","name","uop","args","__call__","__new__","Object","getOwnPropertyDescriptors","writable","mcall","assert","cond","msg","attr","setattr","obj","key","value","getKW","setKW","tmp","getTmp","saveTmp","v","withTmp","getModule","async","module","modules","__BRYTHON__","imported","pyobj2jsob","getModuleSync","abs","range","beg","end","inc","i","Exception","IVALUE","__JS_SET_IVALUE__","self","__JS_GET_IVALUE__","RBrythonGlobalRunner","run","jscode","this","runFunction","loadAsFunction","runSync","runSyncFunction","loadAsSyncFunction","eval","registerModule","symbols","registerBuiltins","registerBuiltin","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","__webpack_modules__","d","definition","defineProperty","enumerable","get","prop","hasOwnProperty","runner","builtins","require","builtin"],"sourceRoot":""}